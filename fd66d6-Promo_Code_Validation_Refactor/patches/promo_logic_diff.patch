diff --git a/repository_before/payments.service.ts b/repository_after/payments.service.ts
index cf81269..c19066e 100644
--- a/repository_before/payments.service.ts
+++ b/repository_after/payments.service.ts
@@ -3,7 +3,6 @@ import {
   BadRequestException,
   InternalServerErrorException,
   ForbiddenException,
-  UnauthorizedException,
   Logger,
   NotFoundException,
   HttpException,
@@ -100,7 +99,6 @@ export class PaymentsService {
   }
 
   async createPortalSession(customerId: string, userId: string) {
-    // Added userId for verification
     if (!customerId) {
       throw new BadRequestException('Customer ID is required');
     }
@@ -109,7 +107,6 @@ export class PaymentsService {
       throw new InternalServerErrorException('Supabase client not available');
     }
 
-    // Verify customer ownership
     const { data: parent, error: fetchError } = await client
       .from('parents')
       .select('stripe_customer_id')
@@ -147,12 +144,9 @@ export class PaymentsService {
       throw new InternalServerErrorException('Supabase client not available');
     }
 
-    this.logger.log('dto.returnUrl=', dto.returnUrl);
-    this.logger.log('BASE_URL=', this.configService.get('BASE_URL'));
     const baseReturnUrl = dto.returnUrl
       ? `${this.configService.get('BASE_URL')}${dto.returnUrl}`
       : `${this.configService.get('BASE_URL')}/parent/settings/subscription`;
-    this.logger.log('baseReturnUrl=', baseReturnUrl);
     const cancelBaseUrl = dto.returnUrl
       ? `${this.configService.get('BASE_URL')}${dto.returnUrl}`
       : `${this.configService.get('BASE_URL')}`;
@@ -176,8 +170,8 @@ export class PaymentsService {
     const countryCode = data?.countries?.country_code;
     const locale = countryCode ? countryLocaleMap[countryCode] || countryLocaleMap.DEFAULT : countryLocaleMap.DEFAULT;
 
-    // Build Stripe checkout session config
-    const sessionConfig: any = {
+    // Build Stripe checkout session with promotion codes enabled
+    const sessionConfig: Stripe.Checkout.SessionCreateParams = {
       customer: dto.customer_id,
       success_url: successUrl.toString(),
       cancel_url: cancelUrl.toString(),
@@ -209,6 +203,7 @@ export class PaymentsService {
           : []),
       ],
       mode: 'subscription',
+      allow_promotion_codes: true, // Let Stripe handle promo codes
       metadata: {
         students: JSON.stringify(dto.students),
         user_id: dto.user_id,
@@ -235,11 +230,6 @@ export class PaymentsService {
       locale,
     };
 
-    // Apply promo code if provided
-    if (dto.promo_code_api_id) {
-      sessionConfig.discounts = [{ promotion_code: dto.promo_code_api_id }];
-    }
-
     try {
       const session = await this.stripe.checkout.sessions.create(sessionConfig);
       return { link: session.url };
@@ -463,4 +453,4 @@ export class PaymentsService {
     }
     return 'USD';
   }
-}
+}
\ No newline at end of file
diff --git a/repository_before/subscription.vue b/repository_after/subscription.vue
index e6a9f4e..99bc8b8 100644
--- a/repository_before/subscription.vue
+++ b/repository_after/subscription.vue
@@ -126,8 +126,8 @@ const openChooseChildernBottomSheet = async () => {
 };
 
 const loading = ref(false);
-// Handle subscription activation with promo code support
-const handleActivation = async (selectedKids: { student_id: string; promo_code_api_id?: string }) => {
+// Handle subscription activation (promo codes handled by Stripe)
+const handleActivation = async (selectedKids: { student_id: string }) => {
   if (!selectedPlan.value) return;
   const user = useSupabaseUser();
   loading.value = true;
@@ -153,7 +153,6 @@ const handleActivation = async (selectedKids: { student_id: string; promo_code_a
         return;
       }
     }
-    // Build subscription payload with promo code
     const subscribePayload: PaymentsSubscribePayload = {
       customer_id: parentData.value.stripe_customer_id,
       price: selectedPrice.id,
@@ -162,7 +161,6 @@ const handleActivation = async (selectedKids: { student_id: string; promo_code_a
       returnUrl: '/parent/settings/my-plan',
       plan_type: billingPeriod.value,
       user_id: user.value.id,
-      promo_code_api_id: selectedKids.promo_code_api_id,
       currency: selectedPrice.currency,
     };
 
@@ -236,7 +234,6 @@ parentData.value = await fetchUserData();
 
 onMounted(async () => {
   if (parentData.value?.uuid) {
-    // @ts-ignore
     myKids.value = await fetchMyKids(parentData.value.uuid);
   }
 });
@@ -257,7 +254,6 @@ onMounted(() => {
   features.value = [];
 
   availablePlanTypes.forEach((planType) => {
-    // Your original switch logic
     switch (planType) {
       case PLAN_NAMES.BASIC:
         selectedPlan.value = basicPlan.value;
@@ -363,7 +359,7 @@ const goToPortal = async () => {
   try {
     const session = await paymentsApi.createPortalSession(parentData.value.stripe_customer_id);
     if (session?.url) {
-      window.location.href = session.url; // Redirect to the Stripe portal
+      window.location.href = session.url;
     }
   } catch (error) {
     console.error('Error creating portal session:', error);
@@ -751,4 +747,4 @@ const handlePlanSelection = (planType: string) => {
   position: absolute;
   top: -15px;
 }
-</style>
+</style>
\ No newline at end of file
